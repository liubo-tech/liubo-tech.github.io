(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{371:function(a,s,t){a.exports=t.p+"assets/img/image-20200426110603566.52ee28aa.png"},372:function(a,s,t){a.exports=t.p+"assets/img/image-20200426154156002.abafcc50.png"},373:function(a,s,t){a.exports=t.p+"assets/img/image-20200426162109087.174760a1.png"},374:function(a,s,t){a.exports=t.p+"assets/img/image-20200426162306090.afc65603.png"},455:function(a,s,t){"use strict";t.r(s);var e=t(42),r=Object(e.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"es7学习笔记-三-新建索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#es7学习笔记-三-新建索引"}},[a._v("#")]),a._v(" ES7学习笔记（三）新建索引")]),a._v(" "),e("h2",{attrs:{id:"与es的交互方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#与es的交互方式"}},[a._v("#")]),a._v(" 与ES的交互方式")]),a._v(" "),e("p",[a._v("与es的交互方式采用http的请求方式，请求的格式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" -X"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("VERB"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'<PROTOCOL>://<HOST>:<PORT>/<PATH>?<QUERY_STRING>'")]),a._v(" -d "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v("'<BODY>'")]),a._v("\n")])])]),e("ul",[e("li",[e("VERB",[a._v("是请求的方法，比如：GET、POST、DELETE、PUT等。\n")])],1),a._v(" "),e("li",[e("PROTOCOL",[a._v(" 协议：http或者https。\n")])],1),a._v(" "),e("li",[e("HOST",[a._v("主机地址。\n")])],1),a._v(" "),e("li",[e("PORT",[a._v("端口\n")])],1),a._v(" "),e("li",[e("PATH",[a._v("API的路径。比如查看集群状态：`/_cluster/stats`。\n")])]),a._v(" "),e("li",[e("QUERY_STRING",[a._v("参数。比如：?pretty，打印出格式化以后的Json。\n")])],1),a._v(" "),e("li",[e("BODY",[a._v("请求的内容。比如：添加索引时的数据。\n")])],1)]),a._v(" "),e("h2",{attrs:{id:"创建索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建索引"}},[a._v("#")]),a._v(" 创建索引")]),a._v(" "),e("p",[a._v("es创建索引的请求方式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("PUT /"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("index"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),e("ul",[e("li",[a._v("请求的方法用"),e("code",[a._v("PUT")]),a._v("。")]),a._v(" "),e("li",[a._v("/后面直接跟索引的名称即可。")]),a._v(" "),e("li",[a._v("索引的设置和字段都放在Body中。")])]),a._v(" "),e("p",[a._v("比如我们创建一个名字叫"),e("code",[a._v("组织机构")]),a._v("的索引，这个索引只有两个字段，一个id，一个name。并且这个索引设置为2个分片，2个副本。")]),a._v(" "),e("p",[a._v("我们使用POSTMAN发送请求，如下：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("http://192.168.73.130:9200/orgnization\n")])])]),e("p",[a._v("请求的方法选择"),e("code",[a._v("PUT")]),a._v("。然后在请求体（Body）中，写上索引的字段名称，索引的分片数和副本数，如下：")]),a._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"settings"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"number_of_shards"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"number_of_replicas"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"mappings"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"properties"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"long"')]),a._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"text"')]),a._v("\n            "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),e("p",[a._v("我们观察一下，请求体中分为两个部分："),e("code",[a._v("settings")]),a._v("和"),e("code",[a._v("mappings")]),a._v("。在"),e("code",[a._v("settings")]),a._v("中，我们设置了分片数和副本数。")]),a._v(" "),e("ul",[e("li",[e("code",[a._v("number_of_shards")]),a._v("：分片的数量；")]),a._v(" "),e("li",[e("code",[a._v("number_of_replicas")]),a._v("：副本的数量；")])]),a._v(" "),e("p",[a._v("在"),e("code",[a._v("mappings")]),a._v("中，我们设置索引的字段，在这里，我们只设置了id和name，id的映射类型是long，name的映射类型是text。这些类型我们会在后续为大家介绍。")]),a._v(" "),e("p",[a._v("请求体写完后，我们点击发送，es返回的结果如下：")]),a._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"acknowledged"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"shards_acknowledged"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[a._v('"index"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[a._v('"orgnization"')]),a._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),e("p",[a._v("说明索引创建成功，索引的名字正是我们在请求中设置的"),e("code",[a._v("orgnization")]),a._v("。")]),a._v(" "),e("p",[a._v("然后，我们通过"),e("code",[a._v("elasticsearch-head")]),a._v("插件观察一下刚才创建的索引，如图：")]),a._v(" "),e("p",[e("img",{attrs:{src:t(371),alt:"image-20200426110603566"}})]),a._v(" "),e("p",[a._v("我们可以看到索引"),e("code",[a._v("orgnization")]),a._v("已经创建好了，它有2个分片，分别是0和1，并且每个分片都是两个副本。如果我们仔细观察这个图，可以看出"),e("code",[a._v("node-130")]),a._v("节点中的0分片，和"),e("code",[a._v("node-132")]),a._v("节点中的1分片，它们的边框是加粗的，这说明它们是主节点，而边框没有加粗的节点是从节点，也就是我们说的副本节点。")]),a._v(" "),e("h2",{attrs:{id:"查看索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查看索引"}},[a._v("#")]),a._v(" 查看索引")]),a._v(" "),e("p",[a._v("如果我们要查看一个索引的设置，可以通过如下请求方式：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("GET /"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("index"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),e("p",[a._v("在我们的例子中，查看"),e("code",[a._v("orgnization")]),a._v("索引的设置，我们在POSTMAN中发送如下的请求：")]),a._v(" "),e("p",[e("img",{attrs:{src:t(372),alt:"image-20200426154156002"}})]),a._v(" "),e("p",[a._v("我们可以看到索引的具体设置，比如：mapping的设置，分片和副本的设置。这些和我们创建索引时候的设置是一样的。")]),a._v(" "),e("h2",{attrs:{id:"修改索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改索引"}},[a._v("#")]),a._v(" 修改索引")]),a._v(" "),e("p",[a._v("索引一旦创建，我们是无法修改里边的内容的，不如说修改索引字段的名称。但是我们是可以向索引中添加其他字段的，添加字段的方式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("PUT /"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("index"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/_mapping\n")])])]),e("p",[a._v("然后在我们的请求体中，写好新添加的字段。比如，在我们的例子当中，新添加一个type字段，它的类型我们定义为long，请求如下：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("http://192.168.73.130:9200/orgnization/_mapping\n")])])]),e("p",[a._v("请求类型要改为"),e("code",[a._v("PUT")]),a._v("，请求体如下：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v('{\n  "properties": {\n    "type": {\n      "type": "long"\n    }\n  }\n}\n')])])]),e("p",[a._v("我们点击发送，返回的结果如图所示：")]),a._v(" "),e("p",[e("img",{attrs:{src:t(373),alt:"image-20200426162109087"}})]),a._v(" "),e("p",[a._v("添加索引字段成功，我们再使用"),e("code",[a._v("GET")]),a._v("查看一下索引，如图：")]),a._v(" "),e("p",[e("img",{attrs:{src:t(374),alt:"image-20200426162306090"}})]),a._v(" "),e("p",[a._v("我们可以成功的查询到新添加的索引字段了。")]),a._v(" "),e("h2",{attrs:{id:"删除索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#删除索引"}},[a._v("#")]),a._v(" 删除索引")]),a._v(" "),e("p",[a._v("如果我们要删除一个索引，请求方式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("DELETE /"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("index"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])])]),e("p",[a._v("假如我们要删除刚才创建的"),e("code",[a._v("orgnization")]),a._v("索引，我们只要把请求的方法改成"),e("code",[a._v("DELETE")]),a._v("，然后访问我们索引就可以，")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("http://192.168.73.130:9200/orgnization\n")])])]),e("h2",{attrs:{id:"关闭索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#关闭索引"}},[a._v("#")]),a._v(" 关闭索引")]),a._v(" "),e("p",[a._v("如果索引被关闭，那么关于这个索引的所有读写操作都会被阻断。索引的关闭也很简单，请求方式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("POST /"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("index"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/_close\n")])])]),e("p",[a._v("在我们的例子中，如果要关闭索引，降请求方法改成"),e("code",[a._v("POST")]),a._v("，然后发送如下请求：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("http://192.168.73.130:9200/orgnization/_close\n")])])]),e("h2",{attrs:{id:"打开索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#打开索引"}},[a._v("#")]),a._v(" 打开索引")]),a._v(" "),e("p",[a._v("与关闭索引相对应的是打开索引，请求方式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("POST /"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("index"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/_open\n")])])]),e("p",[a._v("在我们的例子中，如果要打开索引，降请求方法改成"),e("code",[a._v("POST")]),a._v("，然后发送如下请求：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("http://192.168.73.130:9200/orgnization/_open\n")])])]),e("h2",{attrs:{id:"冻结索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#冻结索引"}},[a._v("#")]),a._v(" 冻结索引")]),a._v(" "),e("p",[a._v("冻结索引和关闭索引类似，关闭索引是既不能读，也不能写。而冻结索引是可以读，但是不能写。冻结索引的请求方式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("POST /"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("index"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/_freeze\n")])])]),e("p",[a._v("对应我们的例子当中：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("http://192.168.73.130:9200/orgnization/_freeze\n")])])]),e("h2",{attrs:{id:"解冻索引"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解冻索引"}},[a._v("#")]),a._v(" 解冻索引")]),a._v(" "),e("p",[a._v("与冻结索引对应的是解冻索引，方式如下：")]),a._v(" "),e("div",{staticClass:"language-shell extra-class"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[a._v("POST /"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("index"),e("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("/_unfreeze\n")])])]),e("p",[a._v("对应我们的例子：")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("http://192.168.73.130:9200/orgnization/_unfreeze\n")])])]),e("p",[a._v("这节内容到这里就结束了。。")])])}),[],!1,null,null,null);s.default=r.exports}}]);