<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>都知道Base64，Base32你能实现吗？ | 牛初九博客</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="Java 技术 互联网 Spring Redis Mysql ">
    <meta name="keywords" content="Java 技术 互联网 Spring SpringBoot SpringCloud Elastic Search MySQL MyCAT 分布式 集群">
    
    <link rel="preload" href="/assets/css/0.styles.fab77d47.css" as="style"><link rel="preload" href="/assets/js/app.16ffb530.js" as="script"><link rel="preload" href="/assets/js/2.2805d820.js" as="script"><link rel="preload" href="/assets/js/12.ffa316c1.js" as="script"><link rel="prefetch" href="/assets/js/10.7af0fa3b.js"><link rel="prefetch" href="/assets/js/11.bf2b4ef3.js"><link rel="prefetch" href="/assets/js/13.7bf9e28b.js"><link rel="prefetch" href="/assets/js/14.fe8172bf.js"><link rel="prefetch" href="/assets/js/15.12492866.js"><link rel="prefetch" href="/assets/js/16.1e0b9828.js"><link rel="prefetch" href="/assets/js/17.5274e857.js"><link rel="prefetch" href="/assets/js/18.14c495e2.js"><link rel="prefetch" href="/assets/js/19.0065f7d5.js"><link rel="prefetch" href="/assets/js/20.15195b8f.js"><link rel="prefetch" href="/assets/js/21.a49d2486.js"><link rel="prefetch" href="/assets/js/22.7625f3ea.js"><link rel="prefetch" href="/assets/js/23.6829be75.js"><link rel="prefetch" href="/assets/js/24.d89bf6ba.js"><link rel="prefetch" href="/assets/js/25.f9c8e982.js"><link rel="prefetch" href="/assets/js/26.df00cb25.js"><link rel="prefetch" href="/assets/js/27.c2c39573.js"><link rel="prefetch" href="/assets/js/28.9d6955a7.js"><link rel="prefetch" href="/assets/js/29.793a5925.js"><link rel="prefetch" href="/assets/js/3.99170183.js"><link rel="prefetch" href="/assets/js/30.1d4eb018.js"><link rel="prefetch" href="/assets/js/31.c3635b83.js"><link rel="prefetch" href="/assets/js/32.39f76767.js"><link rel="prefetch" href="/assets/js/33.9623bd00.js"><link rel="prefetch" href="/assets/js/34.685b37ce.js"><link rel="prefetch" href="/assets/js/35.b6d262de.js"><link rel="prefetch" href="/assets/js/36.706cce0c.js"><link rel="prefetch" href="/assets/js/37.4b559cf9.js"><link rel="prefetch" href="/assets/js/38.8440f0a1.js"><link rel="prefetch" href="/assets/js/39.89829fe9.js"><link rel="prefetch" href="/assets/js/4.44e35b71.js"><link rel="prefetch" href="/assets/js/40.1eae592a.js"><link rel="prefetch" href="/assets/js/41.307e59e5.js"><link rel="prefetch" href="/assets/js/42.9c9598a9.js"><link rel="prefetch" href="/assets/js/43.6de9381c.js"><link rel="prefetch" href="/assets/js/44.0bda172b.js"><link rel="prefetch" href="/assets/js/45.7bd4678e.js"><link rel="prefetch" href="/assets/js/46.9601296c.js"><link rel="prefetch" href="/assets/js/47.8279d007.js"><link rel="prefetch" href="/assets/js/48.e8ae43c5.js"><link rel="prefetch" href="/assets/js/49.088eb890.js"><link rel="prefetch" href="/assets/js/5.7b7d1525.js"><link rel="prefetch" href="/assets/js/50.a104d084.js"><link rel="prefetch" href="/assets/js/51.0c101ee6.js"><link rel="prefetch" href="/assets/js/52.4269f250.js"><link rel="prefetch" href="/assets/js/53.1c55a938.js"><link rel="prefetch" href="/assets/js/54.dab6fc62.js"><link rel="prefetch" href="/assets/js/55.18a1bf4c.js"><link rel="prefetch" href="/assets/js/56.b2c0ee59.js"><link rel="prefetch" href="/assets/js/57.0a78afcc.js"><link rel="prefetch" href="/assets/js/58.d75522d5.js"><link rel="prefetch" href="/assets/js/59.2543ea7e.js"><link rel="prefetch" href="/assets/js/6.6d27b31c.js"><link rel="prefetch" href="/assets/js/60.16f65788.js"><link rel="prefetch" href="/assets/js/61.d6e2d8b6.js"><link rel="prefetch" href="/assets/js/62.183c4095.js"><link rel="prefetch" href="/assets/js/63.920617f0.js"><link rel="prefetch" href="/assets/js/64.5b2731e6.js"><link rel="prefetch" href="/assets/js/65.56420cc0.js"><link rel="prefetch" href="/assets/js/66.2ebd0c92.js"><link rel="prefetch" href="/assets/js/67.a414b285.js"><link rel="prefetch" href="/assets/js/68.989dacce.js"><link rel="prefetch" href="/assets/js/69.79a844b9.js"><link rel="prefetch" href="/assets/js/7.fee5c0b2.js"><link rel="prefetch" href="/assets/js/70.b789f7cb.js"><link rel="prefetch" href="/assets/js/71.90a71409.js"><link rel="prefetch" href="/assets/js/72.0dee4533.js"><link rel="prefetch" href="/assets/js/73.72b757a5.js"><link rel="prefetch" href="/assets/js/74.5cc6a8e7.js"><link rel="prefetch" href="/assets/js/75.a3efa729.js"><link rel="prefetch" href="/assets/js/76.ee52fbb0.js"><link rel="prefetch" href="/assets/js/77.2c257317.js"><link rel="prefetch" href="/assets/js/78.831d9b7b.js"><link rel="prefetch" href="/assets/js/79.7940520a.js"><link rel="prefetch" href="/assets/js/8.7f9f9c54.js"><link rel="prefetch" href="/assets/js/80.2f951622.js"><link rel="prefetch" href="/assets/js/81.fb674315.js"><link rel="prefetch" href="/assets/js/82.b9069b51.js"><link rel="prefetch" href="/assets/js/83.d718aedc.js"><link rel="prefetch" href="/assets/js/84.95180f04.js"><link rel="prefetch" href="/assets/js/85.3253eaff.js"><link rel="prefetch" href="/assets/js/86.3663d770.js"><link rel="prefetch" href="/assets/js/87.0c11349f.js"><link rel="prefetch" href="/assets/js/88.f5fac9dc.js"><link rel="prefetch" href="/assets/js/89.5e9c86e8.js"><link rel="prefetch" href="/assets/js/9.759c07c6.js"><link rel="prefetch" href="/assets/js/90.faeb161a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fab77d47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">牛初九博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/gzh/gzh.html" class="nav-link">
  公众号
</a></div><div class="nav-item"><a href="/es/es.html" class="nav-link">
  ES系列
</a></div><div class="nav-item"><a href="/rocket/rocket.html" class="nav-link">
  RocketMQ系列
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="慕课课程" class="dropdown-title"><span class="title">慕课课程</span> <span class="arrow down"></span></button> <button type="button" aria-label="慕课课程" class="mobile-dropdown-title"><span class="title">慕课课程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://coding.imooc.com/class/341.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  精讲分布式定时任务
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://class.imooc.com/sale/javaarchitect" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java架构师直通车
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/gzh/gzh.html" class="nav-link">
  公众号
</a></div><div class="nav-item"><a href="/es/es.html" class="nav-link">
  ES系列
</a></div><div class="nav-item"><a href="/rocket/rocket.html" class="nav-link">
  RocketMQ系列
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="慕课课程" class="dropdown-title"><span class="title">慕课课程</span> <span class="arrow down"></span></button> <button type="button" aria-label="慕课课程" class="mobile-dropdown-title"><span class="title">慕课课程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://coding.imooc.com/class/341.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  精讲分布式定时任务
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://class.imooc.com/sale/javaarchitect" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java架构师直通车
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/article/nacos.html" class="sidebar-link">注册中心Nacos集群搭建</a></li><li><a href="/article/nacos-1.html" class="sidebar-link">Nacos配置中心和服务的注册发现</a></li><li><a href="/article/login.html" class="sidebar-link">怎样实现登录？| Cookie or JWT</a></li><li><a href="/article/oauth.html" class="sidebar-link">OAuth授权</a></li><li><a href="/article/sso.html" class="sidebar-link">SSO单点登录流程</a></li><li><a href="/article/front-back.html" class="sidebar-link">前后端分离 | 登录状态</a></li><li><a href="/article/MySQL+Keepalived.html" class="sidebar-link">MySQL+Keepalived高可用</a></li><li><a href="/article/mysql-ms.html" class="sidebar-link">MySQL主从同步配置</a></li><li><a href="/article/mysql-huan.html" class="sidebar-link">MySQL中的幻读，你真的理解吗？</a></li><li><a href="/article/db-pool.html" class="sidebar-link">数据库连接池数量设置为多少？</a></li><li><a href="/article/CSRF.html" class="sidebar-link">CSRF的原理与防御</a></li><li><a href="/article/redis-lock.html" class="sidebar-link">Redis分布式锁</a></li><li><a href="/article/limit.html" class="sidebar-link">MySql分页查询慢</a></li><li><a href="/article/taglib.html" class="sidebar-link">自制权限框架（一）jsp标签</a></li><li><a href="/article/annotation.html" class="sidebar-link">自制权限框架（二）注解</a></li><li><a href="/article/jmeter-1.html" class="sidebar-link">JMeter测试（一）</a></li><li><a href="/article/jmeter-2.html" class="sidebar-link">JMeter测试（二）</a></li><li><a href="/article/spring-security.html" class="sidebar-link">Spring Security实现RBAC权限管理</a></li><li><a href="/article/nginx1.html" class="sidebar-link">Nginx简介（一）</a></li><li><a href="/article/nginx2.html" class="sidebar-link">Nginx简介（二）</a></li><li><a href="/article/string.html" class="sidebar-link">String是值传递还是引用传递</a></li><li><a href="/article/redis-cluster.html" class="sidebar-link">Redis集群</a></li><li><a href="/article/cas.html" class="sidebar-link">CAS与OAuth2的区别</a></li><li><a href="/article/spring-eureka-2.html" class="sidebar-link">Eureka服务注册与发现</a></li><li><a href="/article/spring-mobile.html" class="sidebar-link">Spring Mobile</a></li><li><a href="/article/es-1.html" class="sidebar-link">ES学习（一）ES的安装与启动</a></li><li><a href="/article/es-2.html" class="sidebar-link">ES学习（二）ES的集群原理</a></li><li><a href="/article/es-3.html" class="sidebar-link">ES学习（三）新建索引</a></li><li><a href="/article/es-4.html" class="sidebar-link">ES学习（四）字段类型（mapping）</a></li><li><a href="/article/es-5.html" class="sidebar-link">ES学习（五）动态映射</a></li><li><a href="/article/es-6.html" class="sidebar-link">ES学习（六）分析器</a></li><li><a href="/article/es-7.html" class="sidebar-link">ES学习（七）IK中文分词器</a></li><li><a href="/article/es-8.html" class="sidebar-link">ES学习（八）数据的增删改</a></li><li><a href="/article/es-9.html" class="sidebar-link">ES学习（九）搜索</a></li><li><a href="/article/es-10.html" class="sidebar-link">ES学习（十）聚合查询</a></li><li><a href="/article/es-11.html" class="sidebar-link">ES学习（十一）与SpringBoot结合</a></li><li><a href="/article/es-12.html" class="sidebar-link">ES学习（十二）高亮 和 搜索建议</a></li><li><a href="/article/es-13.html" class="sidebar-link">ES学习（十三）GEO位置搜索</a></li><li><a href="/article/rocketmq-1.html" class="sidebar-link">RocketMQ系列（一）基本概念</a></li><li><a href="/article/rocketmq-2.html" class="sidebar-link">RocketMQ系列（二）环境搭建</a></li><li><a href="/article/rocketmq-3.html" class="sidebar-link">RocketMQ系列（三）消息的生产与消费</a></li><li><a href="/article/rocketmq-4.html" class="sidebar-link">RocketMQ系列（四）顺序消费</a></li><li><a href="/article/rocketmq-5.html" class="sidebar-link">RocketMQ系列（五）广播与延迟消息</a></li><li><a href="/article/rocketmq-6.html" class="sidebar-link">RocketMQ系列（六）批量发送与过滤</a></li><li><a href="/article/rocketmq-7.html" class="sidebar-link">RocketMQ系列（七）事务消息</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="都知道base64-base32你能实现吗"><a href="#都知道base64-base32你能实现吗" class="header-anchor">#</a> 都知道Base64，Base32你能实现吗？</h1> <p>很长时间没有更新个人博客了，因为前一段时间在换工作，入职了一家新的公司，刚开始需要适应一下新公司的节奏，开始阶段也比较忙。新公司还是有一定的技术气氛的，每周都会有技术分享，而且还会给大家留一些思考题，这次的思考题就是让我们回去实现一个Base32的编码和解码。</p> <p>这可怎么办？Base64也就知道个大概，Base32怎么实现呀？回去一顿恶补，查资料，看Base64源码，最后终于将Base32实现了。</p> <h2 id="base64是干什么用的"><a href="#base64是干什么用的" class="header-anchor">#</a> Base64是干什么用的</h2> <p>要写Base32，就要先理解Base64，那么Base64是干什么用的呢？为什么要有Base64呢？这个是根本原因，把Base64产生的过程搞清楚了，那么Base32，我们就可以依葫芦画瓢了。</p> <p>我们知道在计算机中，数据的单位是字节byte，它是由8位2进制组成的，总共可以有256个不同的数。那么这些二进制的数据要怎么进行传输呢？我们要将其转化为ASCII字符，ASCII字符中包含了33个控制字符（不可见）和95个可见字符，我们如果能将这些二进制的数据转化成这95个可见字符，就可以正常传输了。于是，我们从95个字符中，挑选了64个，将2进制的数据转化为这个64个可见字符，这样就可以正常的传输了，这就是Base64的由来。那这64个字符是什么呢？</p> <p><img src="/assets/img/image-20210120200322327.d8e49508.png" alt="image-20210120200322327"></p> <p>这就是Base64的那64个字符。那么如果我们要实现Base32呢？对了，我们要挑选出32个可见字符，具体如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> toBase32 <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token string">'J'</span><span class="token punctuation">,</span> <span class="token string">'K'</span><span class="token punctuation">,</span> <span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token string">'M'</span><span class="token punctuation">,</span>
  <span class="token string">'N'</span><span class="token punctuation">,</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token string">'Q'</span><span class="token punctuation">,</span> <span class="token string">'R'</span><span class="token punctuation">,</span> <span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token string">'U'</span><span class="token punctuation">,</span> <span class="token string">'V'</span><span class="token punctuation">,</span> <span class="token string">'W'</span><span class="token punctuation">,</span> <span class="token string">'X'</span><span class="token punctuation">,</span> <span class="token string">'Y'</span><span class="token punctuation">,</span> <span class="token string">'Z'</span><span class="token punctuation">,</span>
  <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'5'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>我们挑选了大写的A-Z，再加上0-5，一共32个可见字符。</p> <h2 id="base32是什么规则"><a href="#base32是什么规则" class="header-anchor">#</a> Base32是什么规则</h2> <p>好了，32个可见字符已经选好了，接下来就是将2进制转化成这32个字符的过程。我们先来看一下Base64是一个什么样的转化过程，我们一个字节是8位，而64是2的6次方，也即是一个字节（8位）的数据，我们要截取其中的6位进行编码，取到其可见字符。那么剩余的2位数怎么办呢？它将和下一个自己的前4位组成一个6位的数据进行编码。那么我们需要多少字节才能得到一个完整的不丢位的编码呢？我们要取6和8的最小公倍数，也就是24，24位恰好是3个字节，如果取6位进行编码，则可以取到4个编码。我们看看下面的图就可以更好地理解了，</p> <p><img src="/assets/img/image-20210120202758851.3c294012.png" alt="image-20210120202758851"></p> <ul><li>M，a，n对应的ASCII码分别是77，97，110。</li> <li>对应的二进制是01001101，01100001，01101110。</li> <li>然后我们按照6位截取，恰好能够截取4个编码，对应的6位二进制分别为：010011，010110，000101，101110。</li> <li>对应的64位编码为：T，W，F，u。</li></ul> <p>同理，如果我们要实现Base32怎么办呢？32是2的5次方，那么我们再进行2进制截位时，要一次截取5位。那么一个字节8位，截取了5位，剩下的3位怎么办？同理和下一个字节的前2位组成一个新的5位。那么多少个字节按照5位截取才能不丢位呢？我们要取5和8的最小公倍数，40位，按照5位截取，正好得到8个编码。40位，正好5个字节，所以我们要5个字节分为一组，进行Base32的编码。如下图：</p> <p><img src="/assets/img/image-20210121104139278.66e4c03c.png" alt="image-20210121104139278"></p> <p>对比前面的Base64，Base32就是按照5位去截取，然后去编码表中找到对应的字符。好了，原理我们明白了，下面进入程序阶段。</p> <h2 id="写程序阶段"><a href="#写程序阶段" class="header-anchor">#</a> 写程序阶段</h2> <p>原理明白了，程序怎么写呢？这也就是程序猿的价值所在，把现实中的规则、功能、逻辑用程序把它实现。但是实现Base32也是比较难的，不过有先人给我们留下了Base64，我们参照Base64去实现Base32就容易多了。</p> <h3 id="base32编码"><a href="#base32编码" class="header-anchor">#</a> Base32编码</h3> <p>首先，我们要根据输入字节的长度，确定返回字节的长度，以上面为例，输入字节的长度是5，那么Base32转码后的字节长度就是8。那么如果输入字节的长度是1，返回结果的字节长度是多少呢？这就需要补位了，也就是说输入字节的长度不是5的倍数，我们要进行补位，将其长度补成5的倍数，这样编码以后，返回字节的长度就是8的倍数。这样做，我们不会丢失信息，比如，我们只输入了一个字节，是8位，编码时，截取了前5位，那么剩下的后3位怎么办？不能舍弃吧，我们要在其后面补足40位，补位用0去补，前面截取有剩余的位数再加上后面补位的0，凑成5位，再去编码。其余的，全是0的5位二进制，我们编码成“=”，这个和Base64是一样的。</p> <p>好了，我们先来看看编码后返回字节的长度怎么计算。</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//返回结果的数组长度</span>
<span class="token keyword">int</span> rLength <span class="token operator">=</span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>src<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//返回结果</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">byte</span><span class="token punctuation">[</span>rLength<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>其中src是输入的字节数组；</li> <li>返回长度的公式我们要仔细看一下，对5取整，再乘以8，这是一个最基本的操作，我们用上面的例子套一下，输入字节的长度是5个字节，8*(5/5) = 8，需要返回8个字节。我们再来看看加4的作用，比如我们输入的是1个字节，那么返回几个字节呢？按照前面的要求，如果二进制长度不满40位，要补满40位，也就是输入字节的长度要补满成5的整数倍。这里先加4再对5取整，就可以补位后可以进行完整编码的个数，然后再乘以8，得到返回的字节数。大家可以随便想几个例子，验证一下结果对不对。</li> <li>然后我们定义返回结果的数组。</li></ul> <p>返回结果的数组长度已经确定了，接下来我们做什么呢？当然是编码的工作了，这里我们分为两个步骤：</p> <ol><li>先处理可以正常进行编码的那些字节，也就是满足5的倍数的那些字节，这些字节可以进行5字节到8字节转换的，不需要进行补位。</li> <li>然后处理最后几位，这些是需要补位的，将其补成5个字节。</li></ol> <p>编码的步骤已经确定了，下面要确定可以正常编码的字节长度，以及需要补位的长度，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//正常转换的长度</span>
<span class="token keyword">int</span> normalLength <span class="token operator">=</span> src<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token comment">//补位长度</span>
<span class="token keyword">int</span> fillLength <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">-</span> <span class="token punctuation">(</span>src<span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre></div><p>又是两个计算公式，我们分别看一下：</p> <ol><li>可以正常编码的字节长度，对5取整，再乘以5，过滤掉最后不满足5的倍数的字节，这些过滤掉的字节需要补位，满足5个字节；</li> <li>这一步就是计算最后需要补几位才能满足5的倍数，最后可以得到需要补位的长度，如果输入字节的长度恰好是5的倍数，不需要补位，则计算的结果是0，大家可以验证一下这两个公式。</li></ol> <p>接下来，我们处理一下可以正常编码的字节，如下：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">//输入字节下标</span>
<span class="token keyword">int</span> srcPos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token comment">//返回结果下标</span>
<span class="token keyword">int</span> resultPos <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>srcPos <span class="token operator">&lt;</span> normalLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">long</span> bits <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span><span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">32</span> <span class="token operator">|</span>
    <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span> <span class="token operator">|</span>
    <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token operator">|</span>
    <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span>  <span class="token operator">|</span>
    <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bits <span class="token operator">&gt;&gt;</span> <span class="token number">35</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bits <span class="token operator">&gt;&gt;</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bits <span class="token operator">&gt;&gt;</span> <span class="token number">25</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bits <span class="token operator">&gt;&gt;</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bits <span class="token operator">&gt;&gt;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bits <span class="token operator">&gt;&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bits <span class="token operator">&gt;&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>bits <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><ol><li>我们先定义输入字节的下标和返回结果的下标，用作取值与赋值；</li> <li>再写个while循环，只要输入的字节下标在正常转换的范围内，就可以正常的编码；</li> <li>接下来看看while循环的处理细节，我们先要将5个字节拼成一个40位的二进制，在程序中，我们通过位移运算和 <code>|</code> 或运算得到一个long型的数字，当然它的二进制就是我们用5个字节拼成的。</li> <li><strong>这里有个坑要和大家说明一下，我们第一个字节位移的时候用long转型了，为什么？因为int型在Java中占4个字节，32位，我们左移32位后，它会回到最右侧的位置。而long占64位，我们左移32位是不会循环的。这一点大家要格外注意。</strong></li> <li>接下来就是将这40位的二进制进行分拆，同样通过位移操作，每次从左侧截取5位，我们分别向右移动35、30、25、20、15、10、5、0，然后将其和<code>0x1f</code>进行与操作，<code>0x1f</code>是一个16进制的数，其二进制是0001 1111，对了，就是5个1，移位后和<code>0x1f</code>进行与操作，只留取最右侧的5位二进制，并计算其数值，然后从32位编码表中找到对应的字符。</li></ol> <p>可以正常编码的部分就正常结束了，大家要多多理解位移符号的运用。接下来，我们再看看结尾字节的处理。先上代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>fillLength <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>fillLength<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
      <span class="token keyword">int</span> normalBits1 <span class="token operator">=</span> <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">24</span> <span class="token operator">|</span>
        <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token operator">|</span>
        <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span>  <span class="token operator">|</span>
        <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits1 <span class="token operator">&gt;&gt;</span> <span class="token number">27</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits1 <span class="token operator">&gt;&gt;</span> <span class="token number">22</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits1 <span class="token operator">&gt;&gt;</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits1 <span class="token operator">&gt;&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits1 <span class="token operator">&gt;&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits1 <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits1 <span class="token operator">&lt;&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
      <span class="token keyword">int</span> normalBits2 <span class="token operator">=</span> <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">16</span> <span class="token operator">|</span>
        <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span>
        <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits2 <span class="token operator">&gt;&gt;</span> <span class="token number">19</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits2 <span class="token operator">&gt;&gt;</span> <span class="token number">14</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits2 <span class="token operator">&gt;&gt;</span> <span class="token number">9</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits2 <span class="token operator">&gt;&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits2 <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span>
      <span class="token keyword">int</span> normalBits3 <span class="token operator">=</span> <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span> <span class="token operator">|</span>
        <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits3 <span class="token operator">&gt;&gt;</span> <span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits3 <span class="token operator">&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits3 <span class="token operator">&gt;&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits3 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span>
      <span class="token keyword">int</span> normalBits4 <span class="token operator">=</span> <span class="token punctuation">(</span>src<span class="token punctuation">[</span>srcPos<span class="token punctuation">]</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits4 <span class="token operator">&gt;&gt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">byte</span><span class="token punctuation">)</span> toBase32<span class="token punctuation">[</span><span class="token punctuation">(</span>normalBits4 <span class="token operator">&lt;&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1f</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      result<span class="token punctuation">[</span>resultPos<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'='</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li><code>fillLength</code>就是需要补位的位数，如果等于0，我们就不需要补位了。大于0就需要进行补位。</li> <li>需要补位的情况，我们分为4种，分别为：补1位、补2位、补3位和补4位。</li> <li>我嗯先看看补1位的情况，需要补1位，说明之前剩下4个字节，我们先将这4个字节拼起来，那么第一个字节要向左移动24位，这个和正常情况下第一个字节向左移动的位数是不一样的。剩余的字节分别向左移动相应的位数，大家可以参照程序计算一下。</li> <li>然后将得到的32位二进制数，从最高位每次截取5位，每次向右移动位数分别为27、22、17、12、7、2，注意，最后剩下2位，不足5位，我们要向左移动3位。移位后要和<code>0x1f</code>进行与操作，这个作用和前面是一样的，这里不赘述了。然后将得到的数字在32位编码表中，去除对应的字符。</li> <li>剩下的位数我们统一使用<code>=</code>进行补位。</li></ol> <p>其他的需要补1位、补2位和补3位的情况，我们重复步骤3-步骤5，里边具体的移动位数有所区别，需要大家仔细计算。</p> <p>整个的编码过程到这里就结束了，我们将result数组返回即可。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>到这里，Base32的编码就实现了，大家可以运行一下，这里就不演示了。整个的实现过程大家感觉怎么样，我们总结一下，</p> <ol><li>原理，不知道其原理，我们就没有办法写程序。</li> <li>定义32位字符编码表，大家可以根据个人喜好进行定义，没有标准，只要是可见字符就可以。</li> <li>写程序时，要注意正常位数的计算，补位位数的计算，以及左移右移，都是需要大家仔细思考的。</li></ol> <p>好了，Base32编码的过程就结束了，还缺少解码的过程，我们有时间再补上吧～</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.16ffb530.js" defer></script><script src="/assets/js/2.2805d820.js" defer></script><script src="/assets/js/12.ffa316c1.js" defer></script>
  </body>
</html>
