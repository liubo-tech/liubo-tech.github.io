<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>背景 | 牛初九博客</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="Java 技术 互联网 Spring Redis Mysql ">
    <meta name="keywords" content="Java 技术 互联网 Spring SpringBoot SpringCloud Elastic Search MySQL MyCAT 分布式 集群">
    
    <link rel="preload" href="/assets/css/0.styles.fab77d47.css" as="style"><link rel="preload" href="/assets/js/app.16ffb530.js" as="script"><link rel="preload" href="/assets/js/2.2805d820.js" as="script"><link rel="preload" href="/assets/js/4.44e35b71.js" as="script"><link rel="prefetch" href="/assets/js/10.7af0fa3b.js"><link rel="prefetch" href="/assets/js/11.bf2b4ef3.js"><link rel="prefetch" href="/assets/js/12.ffa316c1.js"><link rel="prefetch" href="/assets/js/13.7bf9e28b.js"><link rel="prefetch" href="/assets/js/14.fe8172bf.js"><link rel="prefetch" href="/assets/js/15.12492866.js"><link rel="prefetch" href="/assets/js/16.1e0b9828.js"><link rel="prefetch" href="/assets/js/17.5274e857.js"><link rel="prefetch" href="/assets/js/18.14c495e2.js"><link rel="prefetch" href="/assets/js/19.0065f7d5.js"><link rel="prefetch" href="/assets/js/20.15195b8f.js"><link rel="prefetch" href="/assets/js/21.a49d2486.js"><link rel="prefetch" href="/assets/js/22.7625f3ea.js"><link rel="prefetch" href="/assets/js/23.6829be75.js"><link rel="prefetch" href="/assets/js/24.d89bf6ba.js"><link rel="prefetch" href="/assets/js/25.f9c8e982.js"><link rel="prefetch" href="/assets/js/26.df00cb25.js"><link rel="prefetch" href="/assets/js/27.c2c39573.js"><link rel="prefetch" href="/assets/js/28.9d6955a7.js"><link rel="prefetch" href="/assets/js/29.793a5925.js"><link rel="prefetch" href="/assets/js/3.99170183.js"><link rel="prefetch" href="/assets/js/30.1d4eb018.js"><link rel="prefetch" href="/assets/js/31.c3635b83.js"><link rel="prefetch" href="/assets/js/32.39f76767.js"><link rel="prefetch" href="/assets/js/33.9623bd00.js"><link rel="prefetch" href="/assets/js/34.685b37ce.js"><link rel="prefetch" href="/assets/js/35.b6d262de.js"><link rel="prefetch" href="/assets/js/36.706cce0c.js"><link rel="prefetch" href="/assets/js/37.4b559cf9.js"><link rel="prefetch" href="/assets/js/38.8440f0a1.js"><link rel="prefetch" href="/assets/js/39.89829fe9.js"><link rel="prefetch" href="/assets/js/40.1eae592a.js"><link rel="prefetch" href="/assets/js/41.307e59e5.js"><link rel="prefetch" href="/assets/js/42.9c9598a9.js"><link rel="prefetch" href="/assets/js/43.6de9381c.js"><link rel="prefetch" href="/assets/js/44.0bda172b.js"><link rel="prefetch" href="/assets/js/45.7bd4678e.js"><link rel="prefetch" href="/assets/js/46.9601296c.js"><link rel="prefetch" href="/assets/js/47.8279d007.js"><link rel="prefetch" href="/assets/js/48.e8ae43c5.js"><link rel="prefetch" href="/assets/js/49.088eb890.js"><link rel="prefetch" href="/assets/js/5.7b7d1525.js"><link rel="prefetch" href="/assets/js/50.a104d084.js"><link rel="prefetch" href="/assets/js/51.0c101ee6.js"><link rel="prefetch" href="/assets/js/52.4269f250.js"><link rel="prefetch" href="/assets/js/53.1c55a938.js"><link rel="prefetch" href="/assets/js/54.dab6fc62.js"><link rel="prefetch" href="/assets/js/55.18a1bf4c.js"><link rel="prefetch" href="/assets/js/56.b2c0ee59.js"><link rel="prefetch" href="/assets/js/57.0a78afcc.js"><link rel="prefetch" href="/assets/js/58.d75522d5.js"><link rel="prefetch" href="/assets/js/59.2543ea7e.js"><link rel="prefetch" href="/assets/js/6.6d27b31c.js"><link rel="prefetch" href="/assets/js/60.16f65788.js"><link rel="prefetch" href="/assets/js/61.d6e2d8b6.js"><link rel="prefetch" href="/assets/js/62.183c4095.js"><link rel="prefetch" href="/assets/js/63.920617f0.js"><link rel="prefetch" href="/assets/js/64.5b2731e6.js"><link rel="prefetch" href="/assets/js/65.56420cc0.js"><link rel="prefetch" href="/assets/js/66.2ebd0c92.js"><link rel="prefetch" href="/assets/js/67.a414b285.js"><link rel="prefetch" href="/assets/js/68.989dacce.js"><link rel="prefetch" href="/assets/js/69.79a844b9.js"><link rel="prefetch" href="/assets/js/7.fee5c0b2.js"><link rel="prefetch" href="/assets/js/70.b789f7cb.js"><link rel="prefetch" href="/assets/js/71.90a71409.js"><link rel="prefetch" href="/assets/js/72.0dee4533.js"><link rel="prefetch" href="/assets/js/73.72b757a5.js"><link rel="prefetch" href="/assets/js/74.5cc6a8e7.js"><link rel="prefetch" href="/assets/js/75.a3efa729.js"><link rel="prefetch" href="/assets/js/76.ee52fbb0.js"><link rel="prefetch" href="/assets/js/77.2c257317.js"><link rel="prefetch" href="/assets/js/78.831d9b7b.js"><link rel="prefetch" href="/assets/js/79.7940520a.js"><link rel="prefetch" href="/assets/js/8.7f9f9c54.js"><link rel="prefetch" href="/assets/js/80.2f951622.js"><link rel="prefetch" href="/assets/js/81.fb674315.js"><link rel="prefetch" href="/assets/js/82.b9069b51.js"><link rel="prefetch" href="/assets/js/83.d718aedc.js"><link rel="prefetch" href="/assets/js/84.95180f04.js"><link rel="prefetch" href="/assets/js/85.3253eaff.js"><link rel="prefetch" href="/assets/js/86.3663d770.js"><link rel="prefetch" href="/assets/js/87.0c11349f.js"><link rel="prefetch" href="/assets/js/88.f5fac9dc.js"><link rel="prefetch" href="/assets/js/89.5e9c86e8.js"><link rel="prefetch" href="/assets/js/9.759c07c6.js"><link rel="prefetch" href="/assets/js/90.faeb161a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fab77d47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">牛初九博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/gzh/gzh.html" class="nav-link">
  公众号
</a></div><div class="nav-item"><a href="/es/es.html" class="nav-link">
  ES系列
</a></div><div class="nav-item"><a href="/rocket/rocket.html" class="nav-link">
  RocketMQ系列
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="慕课课程" class="dropdown-title"><span class="title">慕课课程</span> <span class="arrow down"></span></button> <button type="button" aria-label="慕课课程" class="mobile-dropdown-title"><span class="title">慕课课程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://coding.imooc.com/class/341.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  精讲分布式定时任务
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://class.imooc.com/sale/javaarchitect" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java架构师直通车
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/gzh/gzh.html" class="nav-link">
  公众号
</a></div><div class="nav-item"><a href="/es/es.html" class="nav-link">
  ES系列
</a></div><div class="nav-item"><a href="/rocket/rocket.html" class="nav-link">
  RocketMQ系列
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="慕课课程" class="dropdown-title"><span class="title">慕课课程</span> <span class="arrow down"></span></button> <button type="button" aria-label="慕课课程" class="mobile-dropdown-title"><span class="title">慕课课程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://coding.imooc.com/class/341.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  精讲分布式定时任务
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://class.imooc.com/sale/javaarchitect" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java架构师直通车
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/article/nacos.html" class="sidebar-link">注册中心Nacos集群搭建</a></li><li><a href="/article/nacos-1.html" class="sidebar-link">Nacos配置中心和服务的注册发现</a></li><li><a href="/article/login.html" class="sidebar-link">怎样实现登录？| Cookie or JWT</a></li><li><a href="/article/oauth.html" class="sidebar-link">OAuth授权</a></li><li><a href="/article/sso.html" class="sidebar-link">SSO单点登录流程</a></li><li><a href="/article/front-back.html" aria-current="page" class="active sidebar-link">前后端分离 | 登录状态</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/front-back.html#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/article/front-back.html#同源策略" class="sidebar-link">同源策略</a></li><li class="sidebar-sub-header"><a href="/article/front-back.html#同域下的前后端分离" class="sidebar-link">同域下的前后端分离</a></li><li class="sidebar-sub-header"><a href="/article/front-back.html#不同域下的前后端分离" class="sidebar-link">不同域下的前后端分离</a></li><li class="sidebar-sub-header"><a href="/article/front-back.html#总结" class="sidebar-link">总结</a></li></ul></li><li><a href="/article/MySQL+Keepalived.html" class="sidebar-link">MySQL+Keepalived高可用</a></li><li><a href="/article/mysql-ms.html" class="sidebar-link">MySQL主从同步配置</a></li><li><a href="/article/mysql-huan.html" class="sidebar-link">MySQL中的幻读，你真的理解吗？</a></li><li><a href="/article/db-pool.html" class="sidebar-link">数据库连接池数量设置为多少？</a></li><li><a href="/article/CSRF.html" class="sidebar-link">CSRF的原理与防御</a></li><li><a href="/article/redis-lock.html" class="sidebar-link">Redis分布式锁</a></li><li><a href="/article/limit.html" class="sidebar-link">MySql分页查询慢</a></li><li><a href="/article/taglib.html" class="sidebar-link">自制权限框架（一）jsp标签</a></li><li><a href="/article/annotation.html" class="sidebar-link">自制权限框架（二）注解</a></li><li><a href="/article/jmeter-1.html" class="sidebar-link">JMeter测试（一）</a></li><li><a href="/article/jmeter-2.html" class="sidebar-link">JMeter测试（二）</a></li><li><a href="/article/spring-security.html" class="sidebar-link">Spring Security实现RBAC权限管理</a></li><li><a href="/article/nginx1.html" class="sidebar-link">Nginx简介（一）</a></li><li><a href="/article/nginx2.html" class="sidebar-link">Nginx简介（二）</a></li><li><a href="/article/string.html" class="sidebar-link">String是值传递还是引用传递</a></li><li><a href="/article/redis-cluster.html" class="sidebar-link">Redis集群</a></li><li><a href="/article/cas.html" class="sidebar-link">CAS与OAuth2的区别</a></li><li><a href="/article/spring-eureka-2.html" class="sidebar-link">Eureka服务注册与发现</a></li><li><a href="/article/spring-mobile.html" class="sidebar-link">Spring Mobile</a></li><li><a href="/article/es-1.html" class="sidebar-link">ES学习（一）ES的安装与启动</a></li><li><a href="/article/es-2.html" class="sidebar-link">ES学习（二）ES的集群原理</a></li><li><a href="/article/es-3.html" class="sidebar-link">ES学习（三）新建索引</a></li><li><a href="/article/es-4.html" class="sidebar-link">ES学习（四）字段类型（mapping）</a></li><li><a href="/article/es-5.html" class="sidebar-link">ES学习（五）动态映射</a></li><li><a href="/article/es-6.html" class="sidebar-link">ES学习（六）分析器</a></li><li><a href="/article/es-7.html" class="sidebar-link">ES学习（七）IK中文分词器</a></li><li><a href="/article/es-8.html" class="sidebar-link">ES学习（八）数据的增删改</a></li><li><a href="/article/es-9.html" class="sidebar-link">ES学习（九）搜索</a></li><li><a href="/article/es-10.html" class="sidebar-link">ES学习（十）聚合查询</a></li><li><a href="/article/es-11.html" class="sidebar-link">ES学习（十一）与SpringBoot结合</a></li><li><a href="/article/es-12.html" class="sidebar-link">ES学习（十二）高亮 和 搜索建议</a></li><li><a href="/article/es-13.html" class="sidebar-link">ES学习（十三）GEO位置搜索</a></li><li><a href="/article/rocketmq-1.html" class="sidebar-link">RocketMQ系列（一）基本概念</a></li><li><a href="/article/rocketmq-2.html" class="sidebar-link">RocketMQ系列（二）环境搭建</a></li><li><a href="/article/rocketmq-3.html" class="sidebar-link">RocketMQ系列（三）消息的生产与消费</a></li><li><a href="/article/rocketmq-4.html" class="sidebar-link">RocketMQ系列（四）顺序消费</a></li><li><a href="/article/rocketmq-5.html" class="sidebar-link">RocketMQ系列（五）广播与延迟消息</a></li><li><a href="/article/rocketmq-6.html" class="sidebar-link">RocketMQ系列（六）批量发送与过滤</a></li><li><a href="/article/rocketmq-7.html" class="sidebar-link">RocketMQ系列（七）事务消息</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h2> <p><strong>登录</strong>是一个网站最基础的功能。有人说它很简单，其实不然，登录逻辑很简单，但涉及知识点比较多，如：
密码加密、cookie、session、token、JWT等。</p> <p>我们看一下传统的做法，前后端统一在一个服务中：</p> <p><img src="data:image/png;base64,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" alt="image1"></p> <p>如图所示，逻辑处理和页面放在一个服务中，用户输入用户名、密码后，后台服务在session中设置登录状态，和用户的一些基本信息，
然后将响应（Response）返回到浏览器（Browser），并设置Cookie。下次用户在这个浏览器（Browser）中，再次
访问服务时，请求中会带上这个Cookie，服务端根据这个Cookie就能找到对应的session，从session中取得用户的信息，从而
维持了用户的登录状态。这种机制被称作Cookie-Session机制。</p> <p>近几年，随着前后端分离的流行，我们的项目结构也发生了变化，如下图：</p> <p><img src="data:image/png;base64,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" alt="image2"></p> <p>我们访问一个网站时，先去请求静态服务，拿到页面后，再异步去后台请求数据，最后渲染成我们看到的带有数据的网站。在这种结构下，
我们的登录状态怎么维持呢？上面的Cookie-Session机制还适不适用？</p> <p>这里又分两种情况，服务A和服务B在同一域下，服务A和服务B在不同域下。在详细介绍之前，我们先普及一下<strong>浏览器的同源策略</strong>。</p> <h2 id="同源策略"><a href="#同源策略" class="header-anchor">#</a> 同源策略</h2> <p>同源策略是浏览器保证安全的基础，它的含义是指，A网页设置的 Cookie，B网页不能打开，除非这两个网页同源。
所谓同源是指：</p> <ul><li>协议相同</li> <li>域名相同</li> <li>端口相同</li></ul> <p>例如：http://www.a.com/login，协议是<code>http</code>，域名是<code>www.a.com</code>，端口是<code>80</code>。只要这3个相同，我们就可以在请求（Request）时带上Cookie，
在响应（Response）时设置Cookie。</p> <h2 id="同域下的前后端分离"><a href="#同域下的前后端分离" class="header-anchor">#</a> 同域下的前后端分离</h2> <p>我们了解了浏览器的同源策略，接下来就看一看同域下的前后端分离，首先看服务端能不能设置Cookie，具体代码如下：</p> <p>后端代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;setCookie&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Cookie</span> cookie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;same&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cookie<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们设置Cookie的path为根目录&quot;/&quot;，以便在该域的所有路径下都能看到这个Cookie。</p> <p>前端代码：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                url <span class="token operator">:</span> <span class="token string">&quot;/test/setCookie&quot;</span><span class="token punctuation">,</span>
                method<span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    aaa
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>我们在浏览器访问http://www.a.com:8888/index.html，访问前先设置hosts，<strong>将www.a.com指向我们本机</strong>。访问结果如图所示：</p> <p><img src="/assets/img/fb-3.3fdc9eef.png" alt="image3"></p> <p>我们可以看到服务器成功设置了Cookie。然后我们再看看同域下，异步请求能不能带上Cookie，代码如下：</p> <p>后端代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;getCookie&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Cookie</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cookies <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cookies <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> cookies<span class="token punctuation">.</span>length <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cookie</span> cookie <span class="token operator">:</span> cookies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span> <span class="token operator">+</span> cookie<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;-----value:&quot;</span> <span class="token operator">+</span> cookie<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>前端代码如下：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>user<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.0.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
        <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                url <span class="token operator">:</span> <span class="token string">&quot;http://www.b.com:8888/test/getCookie&quot;</span><span class="token punctuation">,</span>
                method<span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
                <span class="token function-variable function">success</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>访问结果如图所示：</p> <p><img src="/assets/img/fb-4.001882db.png" alt="image4"></p> <p>再看看后台打印的日志：</p> <div class="language- extra-class"><pre class="language-text"><code>name:test-----value:same
</code></pre></div><p>同域下，异步请求时，Cookie也能带到服务端。</p> <p><strong>所以，我们在做前后端分离时，前端和后端部署在同一域下，满足浏览器的同源策略，登录不需要做特殊的处理。</strong></p> <h2 id="不同域下的前后端分离"><a href="#不同域下的前后端分离" class="header-anchor">#</a> 不同域下的前后端分离</h2> <p>不同域下，我们的响应（Response）能不能设置Cookie呢？请求时能不能带上Cookie呢？我们实验结果如下，这里就不给大家贴代码了。</p> <p><img src="/assets/img/fb-5.e58ce0d0.png" alt="image5"></p> <p>由于我们在a.com域下的页面跨域访问b.com的服务，b.com的服务不能设置Cookie。</p> <p>如果b.com域下有Cookie，我们在a.com域下的页面跨域访问b.com的服务，能不能把b.com的Cookie带上吗？答案是也带不上。那么我们怎么解决
跨域问题呢？</p> <h3 id="jsonp解决跨域"><a href="#jsonp解决跨域" class="header-anchor">#</a> JSONP解决跨域</h3> <p>JSONP的原理我们可以在<a href="https://zh.wikipedia.org/wiki/JSONP" target="_blank" rel="noopener noreferrer">维基百科<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>上查看，上面写的很清楚，我们不做过多的介绍。我们改造接口，
在每个接口上增加callback参数：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;setCookie&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span><span class="token class-name">String</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Cookie</span> cookie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;same&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cookie<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> callback<span class="token operator">+</span><span class="token string">&quot;('success')&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;getCookie&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span><span class="token class-name">String</span> callback<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Cookie</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cookies <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cookies <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> cookies<span class="token punctuation">.</span>length <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cookie</span> cookie <span class="token operator">:</span> cookies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span> <span class="token operator">+</span> cookie<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;-----value:&quot;</span> <span class="token operator">+</span> cookie<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> callback<span class="token operator">+</span><span class="token string">&quot;('success')&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果callback参数不为空，将返回js函数。前端改造如下：</p> <p>设置Cookie页面改造如下：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            url <span class="token operator">:</span> <span class="token string">&quot;http://www.b.com:8888/test/setCookie?callback=?&quot;</span><span class="token punctuation">,</span>
            method<span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
            dataType <span class="token operator">:</span> <span class="token string">'jsonp'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>请求Cookie时改造如下：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            url <span class="token operator">:</span> <span class="token string">&quot;http://www.b.com:8888/test/getCookie?callback=?&quot;</span><span class="token punctuation">,</span>
            method<span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
            dataType <span class="token operator">:</span> <span class="token string">'jsonp'</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>所有的请求都加了callback参数，请求的结果如下：</p> <p><img src="/assets/img/fb-6.2d925ded.png" alt="image6"></p> <p><strong>很神奇吧！我们设置了b.com域下的Cookie。</strong> 如果想知道为什么？还是看一看JSONP的原理吧。我们再访问第二个页面，看看Cookie能不能
传到服务。后台打印日志为：</p> <div class="language- extra-class"><pre class="language-text"><code>name:test-----value:same
</code></pre></div><p>好了，<strong>不同域下的前后端分离，可以通过JSONP跨域，从而保持登录状态。</strong> 但是，jsonp本身没有跨域安全规范，一般都是后端进行安全限制，
处理不当很容易造成安全问题。</p> <h3 id="cors解决跨域"><a href="#cors解决跨域" class="header-anchor">#</a> CORS解决跨域</h3> <p>CORS是一个W3C标准，全称是&quot;跨域资源共享&quot;（Cross-origin resource sharing）。CORS需要浏览器和服务器同时支持。目前，所有浏览器都支持该功能，IE浏览器不能低于IE10。
整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。
浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。
如果想要详细理解原理，请参考<a href="https://zh.wikipedia.org/wiki/%E8%B7%A8%E4%BE%86%E6%BA%90%E8%B3%87%E6%BA%90%E5%85%B1%E4%BA%AB" target="_blank" rel="noopener noreferrer">维基百科<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>CORS请求默认不发送Cookie和HTTP认证信息。若要发送Cookie，浏览器和服务端都要做设置，咱们要解决的是跨域后的登录问题，所以要允许跨域发送
Cookie。</p> <p>后端要设置<strong>允许跨域请求的域</strong>和<strong>允许设置和接受Cookie。</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;setCookie&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@CrossOrigin</span><span class="token punctuation">(</span>origins<span class="token operator">=</span><span class="token string">&quot;http://www.a.com:8888&quot;</span><span class="token punctuation">,</span>allowCredentials <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Cookie</span> cookie <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Cookie</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;same&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cookie<span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">addCookie</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;getCookie&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@CrossOrigin</span><span class="token punctuation">(</span>origins<span class="token operator">=</span><span class="token string">&quot;http://www.a.com:8888&quot;</span><span class="token punctuation">,</span>allowCredentials <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getCookie</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Cookie</span><span class="token punctuation">[</span><span class="token punctuation">]</span> cookies <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getCookies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cookies <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> cookies<span class="token punctuation">.</span>length <span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cookie</span> cookie <span class="token operator">:</span> cookies<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;name:&quot;</span> <span class="token operator">+</span> cookie<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;-----value:&quot;</span> <span class="token operator">+</span> cookie<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们通过<code>@CrossOrigin</code>注解允许跨域，<code>origins</code>设置了允许跨域请求的域，<code>allowCredentials</code>允许设置和接受Cookie。</p> <p>前端要设置<strong>允许发送和接受Cookie</strong>。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            url <span class="token operator">:</span> <span class="token string">&quot;http://www.b.com:8888/test/setCookie&quot;</span><span class="token punctuation">,</span>
            method<span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            xhrFields<span class="token operator">:</span> <span class="token punctuation">{</span>
                withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            url <span class="token operator">:</span> <span class="token string">&quot;http://www.b.com:8888/test/getCookie&quot;</span><span class="token punctuation">,</span>
            method<span class="token operator">:</span> <span class="token string">&quot;get&quot;</span><span class="token punctuation">,</span>
            <span class="token function-variable function">success</span> <span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">json</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            xhrFields<span class="token operator">:</span> <span class="token punctuation">{</span>
                withCredentials<span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>我们访问页面看一下效果。</p> <p><img src="/assets/img/fb-7.32257bff.png" alt="image7"></p> <p><strong>没有Cookie吗？别急，我们再从浏览器的设置里看一下。</strong></p> <p><img src="data:image/png;base64,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" alt="image8"></p> <p>有Cookie了，我们再看看访问能不能带上Cookie，后台打印结果如下：</p> <div class="language-html extra-class"><pre class="language-html"><code>name:test-----value:same
</code></pre></div><p>我们使用CORS，也解决了跨域。</p> <h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <p>前后端分离，基于Cookie-Session机制的登录总结如下</p> <ul><li>前后端同域——与普通登录没有区别</li> <li>前后端不同域
<ul><li>JSONP方式实现</li> <li>CORS方式实现</li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/article/sso.html" class="prev">
        SSO单点登录流程
      </a></span> <span class="next"><a href="/article/MySQL+Keepalived.html">
        MySQL+Keepalived高可用
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.16ffb530.js" defer></script><script src="/assets/js/2.2805d820.js" defer></script><script src="/assets/js/4.44e35b71.js" defer></script>
  </body>
</html>
